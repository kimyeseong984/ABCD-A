!pip install ultralytics
import zipfile

zip_path = r"C:\Users\halla\Desktop\ABCD_A_김예성_학습데이터.zip"
extract_to = r"C:\Users\halla\Desktop\abcd-a_A+"  # ✅ 압축을 풀 대상 폴더

with zipfile.ZipFile(zip_path, 'r') as zip_ref:
    zip_ref.extractall(extract_to)

#학습
from ultralytics import YOLO
model = YOLO('yolov8n-seg.pt')  # 또는 yolov8s-seg.pt 등
model.train(
   data = r'C:\Users\halla\Desktop\abcd-a_A+\data.yaml'  # 절대 경로
, #yaml 수정
    epochs=2000, #횟수
    imgsz=640,
    task='segment',
    workers=0,
    patience=0
)
# YOLO 예측 결과 이미지들을 영상으로 변환
import cv2
import os
from glob import glob

# ✅ 위에서 저장한 예측 이미지 폴더
img_folder = r"C:\Users\halla\Desktop\김예성_yolov8_lane_test.zip\train\images"

# ✅ 저장할 영상 경로
output_video = r"C:\Users\halla\Desktop\abcd-a_A+\ABCD.mp4"


# ✅ 이미지 파일 목록 불러오기
img_files = sorted(glob(os.path.join(img_folder, '*.jpg')) + glob(os.path.join(img_folder, '*.png')))
if not img_files:
    print(f"❌ 이미지가 없습니다: {img_folder}")
else:
    # 첫 이미지로 사이즈 설정
    frame = cv2.imread(img_files[0])
    height, width, _ = frame.shape

    # 영상 설정 (FPS 5)
    video = cv2.VideoWriter(output_video, cv2.VideoWriter_fourcc(*'mp4v'), 5, (width, height))

    for img_path in img_files:
        frame = cv2.imread(img_path)
        video.write(frame)

    video.release()
    print(f"✅ 비디오 저장 완료: {output_video}")
